# Телеграм бот Гриша

## Краткое описание

Телеграм бот умеет предоставлять прогноз погоды по запросу с указанием города. Прогноз берем с AccuWeather.com
Бот умеет принимать команды от пользователя, повторяет их, если пользователь не запустил работы с ним, и подсказывает, как вывети команду помощи. Кроме того бот ведет журналы запросов по всем пользователям, которые к нему отправлялись, и позволяет посмотреть этот журнал, или скачать его в разных форматах.

Кроме того - в боте есть маленькая приятная _пасхалочка_

### Логика работы

Без запуска бот обрабатывает 2 команды:
- /help - Выводит текст помощи
- /start - Запускает работу с ботом
- На остальные команды бот гневно ругается

После запуска работы (команда /start) бот слушает следующие команды:
- /forecast <название города> - выполняется запрос к сервису прогнозов погоды, и выводится этот прогноз в чат
- /saveTXT - выгружает историю запросов текущеего пользователя в TXT формате (присылает файл)
- /saveJSON - выгружает историю запросов текущеего пользователя в JSON формате (присылает файл)
- /saveXML - выгружает историю запросов текущеего пользователя в XML формате (присылает файл)
- /log - выводит в чат журнал истории запросов. В методе sednMessage telegram оказывается есть ограничение на длину сообщения, поэтому, если журнал велик - он отправляется в несколько приемов
- _Пасхалочка_ - кому интересно - покопайтесь в коде

Помимо всего - бот отслеживает время работы с пользователем. Если пользователь долго ничего не пишет боту - то бот закрывает активный сеанс работы с пользователем, о чем пишет ему сообщение.

### Прогноз погоды

Прогноз берется с сайта [accuweather.com](accuweather.com). Логика такая:
- Опрелеяем ID города по запросу поиска названия города. 
- Если ID города найдено - запускаем еще один запрос, уже на прогноз погоду по этому ID города. 
- При получении прогноза погоды - красиво его выводим пользователю в чат.

Токен от accuweather имеет ограничение на количество запросов, но для разработки и тестов - хватает.

## Источники знаний:
- [Telegram Bot API](https://core.telegram.org/bots/api)
- [AccuWeather API](https://developer.accuweather.com/apis)
- [Public API](https://github.com/public-apis/public-apis)

## P.S.

Бот написан на Python, т.к. мне интересен именно он (не то, что я плохо к C# отношусь, просто хотелось скилл именно в питоне прокачать). Старался применить знания, котрые на практике буткампа разбирали. Специально не использовал библиотеку telegram, о чем на каждом углу написано. 

Наверно много можно сделать более оптимально (и в плане алгоритма, и в плане кода), но сказалась нехватка времени и небольшой опыт работы с python.

Токены указаны рабочие. Они будут уничтожены после проверки работы преподавателем. Если работу не проверят - уничтожу 03.06.2022.